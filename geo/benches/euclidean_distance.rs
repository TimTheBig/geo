use criterion::{criterion_group, criterion_main};
use geo_3d::algorithm::{ConvexHull, Distance};
use geo_3d::{polygon, Polygon};

fn criterion_benchmark(c: &mut criterion::Criterion) {
    c.bench_function("Polygon Euclidean distance RTree f64", |bencher| {
        let ls = geo_test_fixtures::norway_nonconvex_hull::<f64>();
        let poly1 = Polygon::new(ls, vec![]);
        let poly2 = polygon![
            (x: -6.064453, y: 68.49604, z: -6.064453),
            (x: -7.426758, y: 68.544315, z: -7.426758),
            (x: -9.272461, y: 68.431513, z: -9.272461),
            (x: -10.063477, y: 68.285651, z: -10.063477),
            (x: -10.898438, y: 68.056889, z: -10.898438),
            (x: -11.337891, y: 67.792641, z: -11.337891),
            (x: -11.601563, y: 67.458082, z: -11.601563),
            (x: -11.601563, y: 66.964476, z: -11.601563),
            (x: -11.425781, y: 66.583217, z: -11.425781),
            (x: -11.25, y: 66.319861, z: -11.25),
            (x: -10.898438, y: 65.964377, z: -10.898438),
            (x: -10.678711, y: 65.802776, z: -10.678711),
            (x: -10.283203, y: 65.549367, z: -10.283203),
            (x: -9.975586, y: 65.385147, z: -9.975586),
            (x: -9.448242, y: 65.127638, z: -9.448242),
            (x: -8.701172, y: 64.848937, z: -8.701172),
            (x: -7.910156, y: 64.642704, z: -7.910156),
            (x: -7.075195, y: 64.642704, z: -7.075195),
            (x: -6.416016, y: 64.75539, z: -6.416016),
            (x: -5.361328, y: 64.979359, z: -5.361328),
            (x: -4.790039, y: 65.366837, z: -4.790039),
            (x: -4.526367, y: 65.676381, z: -4.526367),
            (x: -4.482422, y: 66.196009, z: -4.482422),
            (x: -4.614258, y: 66.705169, z: -4.614258),
            (x: -4.87793, y: 67.118748, z: -4.87793),
            (x: -4.174805, y: 67.474922, z: -4.174805),
            (x: -4.833984, y: 67.958148, z: -4.833984),
            (x: -6.064453, y: 68.49604, z: -6.064453),
        ];
        bencher.iter(|| {
            criterion::black_box((&poly1).distance(&poly2));
        });
    });

    c.bench_function(
        "Polygon Euclidean distance rotating calipers f64",
        |bencher| {
            let ls = geo_test_fixtures::norway_convex_hull::<f64>();
            let poly1 = Polygon::new(ls, vec![]).convex_hull().unwrap();
            let poly2 = polygon![
                (x: -6.064453, y: 68.49604, z: -6.064453),
                (x: -7.426758, y: 68.688521, z: -7.426758),
                (x: -8.569336, y: 68.544315, z: -8.569336),
                (x: -9.272461, y: 68.431513, z: -9.272461),
                (x: -10.063477, y: 68.285651, z: -10.063477),
                (x: -10.898438, y: 68.056889, z: -10.898438),
                (x: -11.337891, y: 67.792641, z: -11.337891),
                (x: -11.601563, y: 67.458082, z: -11.601563),
                (x: -11.601563, y: 66.964476, z: -11.601563),
                (x: -11.425781, y: 66.583217, z: -11.425781),
                (x: -11.25, y: 66.319861, z: -11.25),
                (x: -10.898438, y: 65.964377, z: -10.898438),
                (x: -10.678711, y: 65.802776, z: -10.678711),
                (x: -10.283203, y: 65.549367, z: -10.283203),
                (x: -9.975586, y: 65.385147, z: -9.975586),
                (x: -9.448242, y: 65.127638, z: -9.448242),
                (x: -8.701172, y: 64.848937, z: -8.701172),
                (x: -7.910156, y: 64.642704, z: -7.910156),
                (x: -7.075195, y: 64.642704, z: -7.075195),
                (x: -6.416016, y: 64.75539, z: -6.416016),
                (x: -5.361328, y: 64.979359, z: -5.361328),
                (x: -4.790039, y: 65.366837, z: -4.790039),
                (x: -4.526367, y: 65.676381, z: -4.526367),
                (x: -4.482422, y: 66.196009, z: -4.482422),
                (x: -4.614258, y: 66.705169, z: -4.614258),
                (x: -4.87793, y: 67.118748, z: -4.87793),
                (x: -4.174805, y: 67.474922, z: -4.174805),
                (x: -4.833984, y: 67.958148, z: -4.833984),
                (x: -6.064453, y: 68.49604, z: -6.064453),
            ]
            .convex_hull().unwrap();
            bencher.iter(|| {
                criterion::black_box((&poly1).distance(&poly2));
            });
        },
    );
}

criterion_group!(benches, criterion_benchmark);
criterion_main!(benches);
